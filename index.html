<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday â€” Garv</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>

<main class="card">

    <h1>ðŸŽ‰ Happy Birthday Garv! ðŸŽ‰</h1>

    <div id="message" class="typing"></div>

    <!-- Correct music button -->
    <button id="musicBtn" class="music-btn">â–¶ Play Music</button>

    <div class="note">â€” with lots of kasht taken by your homie</div>

</main>

<!-- AUDIO -->
<audio id="bgMusic" src="music.mp3" preload="auto"></audio>

<script>
/* ===========================
      TYPEWRITER TEXT
=========================== */
const TEXT = `Bhaiii tysm for guiding me and explaining things to me for hours like literally saving me every single time. And fr tg that you initiated that convo in the Live Insaan server varna hum aaj dost hi nahi hote ;-; (but aap catfish hote hote bach gaye ðŸ’€).

Anyways ab toh we homies bro daily tea spilling aur aapko gossip karne mein majboor kar diya hai humne lol ðŸ˜‚.

Youâ€™re genuinely an amazing and nice guy, sabka aur mera acha sochne ke liye dhanyawaad! Just be that way alwaysâ€¦ bas thoda gym shym jao aur body banao kya pata koi aapko ched de toh Cynthia poch nahi payegi ðŸ’”ðŸ’€.

Lwky love your music taste ekdum slayyy (95% match ðŸ¥¹) and your crazy humor ðŸ’€.

Waise Sorry but I drag you into all my kands because broâ€¦ ab toh you are the fire brigade aka Taarak Mehta ðŸ˜­ðŸ™ and main obviously Jethiya ðŸ˜ƒ (ik ye line sachme ajeeb thi).

God bless you Bhauu! Enjoy your special day.

And all the bestest for tmrw's physics paper AAG LAGA DENAAA ðŸ”¥

Once Again Happiest birthday Garvitaa ðŸŽ€`;

const target = document.getElementById('message');
let idx = 0;

function typeStep() {
    if (idx >= TEXT.length) return;
    const ch = TEXT[idx++];
    target.innerHTML += (ch === "\n" ? "<br>" : ch);

    let extra = 0;
    if (".!?".includes(ch)) extra = 140;
    else if (",;".includes(ch)) extra = 50;

    setTimeout(typeStep, 24 + extra);
}

/* ===========================
      CONFETTI EFFECT
=========================== */
function spawnConfettiBurst(x, y, count = 18) {
    for (let i = 0; i < count; i++) {
        const el = document.createElement('div');
        el.className = 'confetti';
        const size = 6 + Math.random() * 10;
        el.style.width = size + 'px';
        el.style.height = (size * 0.6) + 'px';
        el.style.left = (x + (Math.random() * 40 - 20)) + 'px';
        el.style.top = (y + (Math.random() * 20 - 10)) + 'px';
        el.style.background = randomColor();
        el.style.transform = `rotate(${Math.random() * 360}deg)`;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 2200);
    }
}

function randomColor() {
    const palette = ['#FFB6C1', '#FFD1A9', '#C6E6FF', '#EAD7FF', '#B8F3D6'];
    return palette[Math.floor(Math.random() * palette.length)];
}

/* ===========================
      SPARKLES ON POINTER MOVE
=========================== */
document.addEventListener('pointermove', (e) => {
    if (Math.random() > 0.25) return;
    const s = document.createElement('div');
    s.className = 'spark';
    s.style.left = (e.pageX + (Math.random() * 14 - 7)) + 'px';
    s.style.top = (e.pageY + (Math.random() * 14 - 7)) + 'px';
    document.body.appendChild(s);
    setTimeout(() => s.remove(), 1400);
});

/* ===========================
          MUSIC BUTTON
=========================== */
const musicBtn = document.getElementById('musicBtn');
const bgm = document.getElementById('bgMusic');

musicBtn.addEventListener('click', async () => {

    try {
        await bgm.play();
        bgm.loop = true;
        bgm.volume = 0.85;
    } catch(e) {}

    // start typewriter
    if (idx === 0) setTimeout(typeStep, 300);

    // confetti burst on button
    const rect = musicBtn.getBoundingClientRect();
    spawnConfettiBurst(rect.left + rect.width / 2, rect.top + rect.height / 2, 22);

    musicBtn.disabled = true;
    musicBtn.textContent = "ðŸŽµ Playing...";
    musicBtn.classList.add("played");
});

// confetti on double-tap anywhere
document.addEventListener('dblclick', (e) => {
    spawnConfettiBurst(e.pageX, e.pageY, 28);
});
</script>

</body>
</html>
